# ----------------------------------------------
# Script Recorded by ANSYS Electronics Desktop Version 2020.2.0
# 16:23:53  March 18, 2021
# ----------------------------------------------
import ScriptEnv
Proj_name = "HFSS_100G EML TOSA_0317_2017"
Design_name = "Cut"

ScriptEnv.Initialize("Ansoft.ElectronicsDesktop")
oDesktop.RestoreWindow()
oProject = oDesktop.SetActiveProject(Proj_name)
oDesign = oProject.SetActiveDesign(Design_name)
oModule = oDesign.GetModule("AnalysisSetup")
oModule.InsertSetup("HfssDriven", 
	[
		"NAME:Setup1",
		"SolveType:="		, "Single",
		"Frequency:="		, "90GHz",
		"MaxDeltaS:="		, 0.005,
		"UseMatrixConv:="	, False,
		"MaximumPasses:="	, 20,
		"MinimumPasses:="	, 1,
		"MinimumConvergedPasses:=", 2,
		"PercentRefinement:="	, 30,
		"IsEnabled:="		, True,
		[
			"NAME:MeshLink",
			"ImportMesh:="		, False
		],
		"BasisOrder:="		, 1,
		"DoLambdaRefine:="	, True,
		"DoMaterialLambda:="	, True,
		"SetLambdaTarget:="	, True,
		"Target:="		, 0.1,
		"UseMaxTetIncrease:="	, False,
		"PortAccuracy:="	, 2,
		"UseABCOnPort:="	, False,
		"SetPortMinMaxTri:="	, False,
		"UseDomains:="		, False,
		"UseIterativeSolver:="	, False,
		"SaveRadFieldsOnly:="	, False,
		"SaveAnyFields:="	, True,
		"IESolverType:="	, "Auto",
		"LambdaTargetForIESolver:=", 0.15,
		"UseDefaultLambdaTgtForIESolver:=", True,
		"IE Solver Accuracy:="	, "Balanced"
	])
oModule.InsertFrequencySweep("Setup1", 
	[
		"NAME:Sweep",
		"IsEnabled:="		, True,
		"RangeType:="		, "LinearStep",
		"RangeStart:="		, "0GHz",
		"RangeEnd:="		, "90GHz",
		"RangeStep:="		, "0.05GHz",
		"Type:="		, "Interpolating",
		"SaveFields:="		, False,
		"SaveRadFields:="	, False,
		"InterpTolerance:="	, 0.5,
		"InterpMaxSolns:="	, 250,
		"InterpMinSolns:="	, 0,
		"InterpMinSubranges:="	, 1,
		"ExtrapToDC:="		, True,
		"MinSolvedFreq:="	, "0.01GHz",
		"InterpUseS:="		, True,
		"InterpUsePortImped:="	, True,
		"InterpUsePropConst:="	, True,
		"UseDerivativeConvergence:=", False,
		"InterpDerivTolerance:=", 0.2,
		"UseFullBasis:="	, True,
		"EnforcePassivity:="	, True,
		"PassivityErrorTolerance:=", 0.0001,
		"EnforceCausality:="	, False
	])
oModule = oDesign.GetModule("ReportSetup")
oModule.CreateReport("TDR", "Terminal Solution Data", "Rectangular Plot", "Setup1 : Sweep", 
	[
		"Domain:="		, "Time",
		"HoldTime:="		, 1,
		"RiseTime:="		, 1.11111111111111E-11,
		"StepTime:="		, 5E-13,
		"Step:="		, True,
		"WindowWidth:="		, 1,
		"WindowType:="		, 2,
		"KaiserParameter:="	, 1,
		"MaximumTime:="		, 3E-10
	], 
	[
		"Time:="		, ["All"],
		"OverridingValues:="	, ["0s","5e-13s","1e-12s","1.5e-12s","2e-12s","2.5e-12s","3e-12s","3.5e-12s","4e-12s","4.5e-12s","5e-12s","5.5e-12s","6e-12s","6.5e-12s","7e-12s","7.5e-12s","8e-12s","8.5e-12s","9e-12s","9.5e-12s","1e-11s","1.05e-11s","1.1e-11s","1.15e-11s","1.2e-11s","1.25e-11s","1.3e-11s","1.35e-11s","1.4e-11s","1.45e-11s","1.5e-11s","1.55e-11s","1.6e-11s","1.65e-11s","1.7e-11s","1.75e-11s","1.8e-11s","1.85e-11s","1.9e-11s","1.95e-11s","2e-11s","2.05e-11s","2.1e-11s","2.15e-11s","2.2e-11s","2.25e-11s","2.3e-11s","2.35e-11s","2.4e-11s","2.45e-11s","2.5e-11s","2.55e-11s","2.6e-11s","2.65e-11s","2.7e-11s","2.75e-11s","2.8e-11s","2.85e-11s","2.9e-11s","2.95e-11s","3e-11s","3.05e-11s","3.1e-11s","3.15e-11s","3.2e-11s","3.25e-11s","3.3e-11s","3.35e-11s","3.4e-11s","3.45e-11s","3.5e-11s","3.55e-11s","3.6e-11s","3.65e-11s","3.7e-11s","3.75e-11s","3.8e-11s","3.85e-11s","3.9e-11s","3.95e-11s","4e-11s","4.05e-11s","4.1e-11s","4.15e-11s","4.2e-11s","4.25e-11s","4.3e-11s","4.35e-11s","4.4e-11s","4.45e-11s","4.5e-11s","4.55e-11s","4.6e-11s","4.65e-11s","4.7e-11s","4.75e-11s","4.8e-11s","4.85e-11s","4.9e-11s","4.95e-11s","5e-11s","5.05e-11s","5.1e-11s","5.15e-11s","5.2e-11s","5.25e-11s","5.3e-11s","5.35e-11s","5.4e-11s","5.45e-11s","5.5e-11s","5.55e-11s","5.59999999999999e-11s","5.64999999999999e-11s","5.69999999999999e-11s","5.74999999999999e-11s","5.79999999999999e-11s","5.84999999999999e-11s","5.89999999999999e-11s","5.94999999999999e-11s","5.99999999999999e-11s","6.04999999999999e-11s","6.09999999999999e-11s","6.14999999999999e-11s","6.19999999999999e-11s","6.24999999999999e-11s","6.29999999999999e-11s","6.34999999999999e-11s","6.39999999999999e-11s","6.44999999999999e-11s","6.49999999999999e-11s","6.54999999999999e-11s","6.59999999999999e-11s","6.64999999999999e-11s","6.69999999999999e-11s","6.74999999999999e-11s","6.79999999999999e-11s","6.84999999999999e-11s","6.89999999999999e-11s","6.94999999999999e-11s","6.99999999999999e-11s","7.04999999999999e-11s","7.09999999999999e-11s","7.14999999999999e-11s","7.19999999999999e-11s","7.24999999999999e-11s","7.29999999999999e-11s","7.34999999999999e-11s","7.39999999999999e-11s","7.44999999999999e-11s","7.49999999999999e-11s","7.54999999999999e-11s","7.59999999999999e-11s","7.64999999999999e-11s","7.69999999999999e-11s","7.74999999999999e-11s","7.79999999999999e-11s","7.84999999999999e-11s","7.89999999999999e-11s","7.94999999999999e-11s","7.99999999999999e-11s","8.04999999999999e-11s","8.09999999999999e-11s","8.14999999999999e-11s","8.19999999999999e-11s","8.24999999999999e-11s","8.29999999999999e-11s","8.34999999999999e-11s","8.39999999999999e-11s","8.44999999999999e-11s","8.49999999999998e-11s","8.54999999999998e-11s","8.59999999999998e-11s","8.64999999999998e-11s","8.69999999999998e-11s","8.74999999999998e-11s","8.79999999999998e-11s","8.84999999999998e-11s","8.89999999999998e-11s","8.94999999999998e-11s","8.99999999999998e-11s","9.04999999999998e-11s","9.09999999999998e-11s","9.14999999999998e-11s","9.19999999999998e-11s","9.24999999999998e-11s","9.29999999999998e-11s","9.34999999999998e-11s","9.39999999999998e-11s","9.44999999999998e-11s","9.49999999999998e-11s","9.54999999999998e-11s","9.59999999999998e-11s","9.64999999999998e-11s","9.69999999999998e-11s","9.74999999999998e-11s","9.79999999999998e-11s","9.84999999999998e-11s","9.89999999999998e-11s","9.94999999999998e-11s","9.99999999999998e-11s","1.005e-10s","1.01e-10s","1.015e-10s","1.02e-10s","1.025e-10s","1.03e-10s","1.035e-10s","1.04e-10s","1.045e-10s","1.05e-10s","1.055e-10s","1.06e-10s","1.065e-10s","1.07e-10s","1.075e-10s","1.08e-10s","1.085e-10s","1.09e-10s","1.095e-10s","1.1e-10s","1.105e-10s","1.11e-10s","1.115e-10s","1.12e-10s","1.125e-10s","1.13e-10s","1.135e-10s","1.14e-10s","1.145e-10s","1.15e-10s","1.155e-10s","1.16e-10s","1.165e-10s","1.17e-10s","1.175e-10s","1.18e-10s","1.185e-10s","1.19e-10s","1.195e-10s","1.2e-10s","1.205e-10s","1.21e-10s","1.215e-10s","1.22e-10s","1.225e-10s","1.23e-10s","1.235e-10s","1.24e-10s","1.245e-10s","1.25e-10s","1.255e-10s","1.26e-10s","1.265e-10s","1.27e-10s","1.275e-10s","1.28e-10s","1.285e-10s","1.29e-10s","1.295e-10s","1.3e-10s","1.305e-10s","1.31e-10s","1.315e-10s","1.32e-10s","1.325e-10s","1.33e-10s","1.335e-10s","1.34e-10s","1.345e-10s","1.35e-10s","1.355e-10s","1.36e-10s","1.365e-10s","1.37e-10s","1.375e-10s","1.38e-10s","1.385e-10s","1.39e-10s","1.395e-10s","1.4e-10s","1.405e-10s","1.41e-10s","1.415e-10s","1.42e-10s","1.425e-10s","1.43e-10s","1.435e-10s","1.44e-10s","1.445e-10s","1.45e-10s","1.455e-10s","1.46e-10s","1.465e-10s","1.47e-10s","1.475e-10s","1.48e-10s","1.485e-10s","1.49e-10s","1.495e-10s","1.5e-10s","1.505e-10s","1.51e-10s","1.515e-10s","1.52e-10s","1.525e-10s","1.53e-10s","1.535e-10s","1.54e-10s","1.545e-10s","1.55e-10s","1.555e-10s","1.56e-10s","1.565e-10s","1.57e-10s","1.575e-10s","1.58e-10s","1.585e-10s","1.59e-10s","1.595e-10s","1.6e-10s","1.605e-10s","1.61e-10s","1.615e-10s","1.62e-10s","1.625e-10s","1.63e-10s","1.635e-10s","1.64e-10s","1.645e-10s","1.65e-10s","1.655e-10s","1.66e-10s","1.665e-10s","1.67e-10s","1.675e-10s","1.68e-10s","1.685e-10s","1.69e-10s","1.695e-10s","1.7e-10s","1.705e-10s","1.71e-10s","1.715e-10s","1.72e-10s","1.725e-10s","1.73e-10s","1.735e-10s","1.74e-10s","1.745e-10s","1.75e-10s","1.755e-10s","1.76e-10s","1.765e-10s","1.77e-10s","1.775e-10s","1.78e-10s","1.785e-10s","1.79e-10s","1.795e-10s","1.8e-10s","1.805e-10s","1.81e-10s","1.815e-10s","1.82e-10s","1.825e-10s","1.83e-10s","1.835e-10s","1.84e-10s","1.845e-10s","1.85e-10s","1.855e-10s","1.86e-10s","1.865e-10s","1.87e-10s","1.875e-10s","1.88e-10s","1.885e-10s","1.89e-10s","1.895e-10s","1.89999999999999e-10s","1.90499999999999e-10s","1.90999999999999e-10s","1.91499999999999e-10s","1.91999999999999e-10s","1.92499999999999e-10s","1.92999999999999e-10s","1.93499999999999e-10s","1.93999999999999e-10s","1.94499999999999e-10s","1.94999999999999e-10s","1.95499999999999e-10s","1.95999999999999e-10s","1.96499999999999e-10s","1.96999999999999e-10s","1.97499999999999e-10s","1.97999999999999e-10s","1.98499999999999e-10s","1.98999999999999e-10s","1.99499999999999e-10s","1.99999999999999e-10s","2.00499999999999e-10s","2.00999999999999e-10s","2.01499999999999e-10s","2.01999999999999e-10s","2.02499999999999e-10s","2.02999999999999e-10s","2.03499999999999e-10s","2.03999999999999e-10s","2.04499999999999e-10s","2.04999999999999e-10s","2.05499999999999e-10s","2.05999999999999e-10s","2.06499999999999e-10s","2.06999999999999e-10s","2.07499999999999e-10s","2.07999999999999e-10s","2.08499999999999e-10s","2.08999999999999e-10s","2.09499999999999e-10s","2.09999999999999e-10s","2.10499999999999e-10s","2.10999999999999e-10s","2.11499999999999e-10s","2.11999999999999e-10s","2.12499999999999e-10s","2.12999999999999e-10s","2.13499999999999e-10s","2.13999999999999e-10s","2.14499999999999e-10s","2.14999999999999e-10s","2.15499999999999e-10s","2.15999999999999e-10s","2.16499999999999e-10s","2.16999999999999e-10s","2.17499999999999e-10s","2.17999999999999e-10s","2.18499999999999e-10s","2.18999999999999e-10s","2.19499999999999e-10s","2.19999999999999e-10s","2.20499999999999e-10s","2.20999999999999e-10s","2.21499999999999e-10s","2.21999999999999e-10s","2.22499999999999e-10s","2.22999999999999e-10s","2.23499999999999e-10s","2.23999999999999e-10s","2.24499999999999e-10s","2.24999999999999e-10s","2.25499999999999e-10s","2.25999999999999e-10s","2.26499999999999e-10s","2.26999999999999e-10s","2.27499999999999e-10s","2.27999999999999e-10s","2.28499999999999e-10s","2.28999999999999e-10s","2.29499999999999e-10s","2.29999999999999e-10s","2.30499999999999e-10s","2.30999999999999e-10s","2.31499999999999e-10s","2.31999999999999e-10s","2.32499999999999e-10s","2.32999999999999e-10s","2.33499999999999e-10s","2.33999999999999e-10s","2.34499999999999e-10s","2.34999999999999e-10s","2.35499999999999e-10s","2.35999999999999e-10s","2.36499999999999e-10s","2.36999999999999e-10s","2.37499999999999e-10s","2.37999999999999e-10s","2.38499999999999e-10s","2.38999999999999e-10s","2.39499999999999e-10s","2.39999999999999e-10s","2.40499999999999e-10s","2.40999999999999e-10s","2.41499999999999e-10s","2.41999999999999e-10s","2.42499999999999e-10s","2.42999999999999e-10s","2.43499999999999e-10s","2.43999999999999e-10s","2.44499999999999e-10s","2.44999999999999e-10s","2.45499999999999e-10s","2.45999999999999e-10s","2.46499999999999e-10s","2.46999999999999e-10s","2.47499999999999e-10s","2.47999999999999e-10s","2.48499999999999e-10s","2.48999999999999e-10s","2.49499999999999e-10s","2.49999999999999e-10s","2.50499999999999e-10s","2.50999999999999e-10s","2.51499999999999e-10s","2.51999999999999e-10s","2.52499999999999e-10s","2.52999999999999e-10s","2.53499999999999e-10s","2.53999999999999e-10s","2.54499999999999e-10s","2.54999999999999e-10s","2.55499999999999e-10s","2.55999999999999e-10s","2.56499999999999e-10s","2.56999999999999e-10s","2.57499999999999e-10s","2.57999999999999e-10s","2.58499999999999e-10s","2.58999999999999e-10s","2.59499999999999e-10s","2.59999999999999e-10s","2.60499999999999e-10s","2.60999999999999e-10s","2.61499999999999e-10s","2.61999999999999e-10s","2.62499999999999e-10s","2.62999999999999e-10s","2.63499999999999e-10s","2.63999999999999e-10s","2.64499999999999e-10s","2.64999999999999e-10s","2.65499999999999e-10s","2.65999999999999e-10s","2.66499999999999e-10s","2.66999999999999e-10s","2.67499999999999e-10s","2.67999999999999e-10s","2.68499999999999e-10s","2.68999999999999e-10s","2.69499999999999e-10s","2.69999999999999e-10s","2.70499999999999e-10s","2.70999999999999e-10s","2.71499999999999e-10s","2.71999999999999e-10s","2.72499999999999e-10s","2.72999999999999e-10s","2.73499999999999e-10s","2.73999999999999e-10s","2.74499999999999e-10s","2.74999999999999e-10s","2.75499999999999e-10s","2.75999999999999e-10s","2.76499999999999e-10s","2.76999999999999e-10s","2.77499999999999e-10s","2.77999999999999e-10s","2.78499999999999e-10s","2.78999999999999e-10s","2.79499999999999e-10s","2.79999999999999e-10s","2.80499999999999e-10s","2.80999999999999e-10s","2.81499999999999e-10s","2.81999999999999e-10s","2.82499999999999e-10s","2.82999999999999e-10s","2.83499999999999e-10s","2.83999999999999e-10s","2.84499999999999e-10s","2.84999999999999e-10s","2.85499999999999e-10s","2.85999999999999e-10s","2.86499999999999e-10s","2.86999999999999e-10s","2.87499999999999e-10s","2.87999999999999e-10s","2.88499999999999e-10s","2.88999999999999e-10s","2.89499999999999e-10s","2.89999999999999e-10s","2.90499999999999e-10s","2.90999999999999e-10s","2.91499999999999e-10s","2.91999999999999e-10s","2.92499999999999e-10s","2.92999999999999e-10s","2.93499999999999e-10s","2.93999999999999e-10s","2.94499999999999e-10s","2.94999999999999e-10s","2.95499999999999e-10s","2.95999999999999e-10s","2.96499999999999e-10s","2.96999999999999e-10s","2.97499999999999e-10s","2.97999999999999e-10s","2.98499999999999e-10s","2.98999999999999e-10s","2.99499999999999e-10s","2.99999999999999e-10s"]
	], 
	[
		"X Component:="		, "Time",
		"Y Component:="		, ["TDRZt(P1)","TDRZt(P2)"]
	])
oModule.CreateReport("S11", "Terminal Solution Data", "Rectangular Plot", "Setup1 : Sweep", 
	[
		"Domain:="		, "Sweep"
	], 
	[
		"Freq:="		, ["All"]
	], 
	[
		"X Component:="		, "Freq",
		"Y Component:="		, ["dB(St(P1,P1))"]
	])
oModule.CreateReport("S21", "Terminal Solution Data", "Rectangular Plot", "Setup1 : Sweep", 
	[
		"Domain:="		, "Sweep"
	], 
	[
		"Freq:="		, ["All"]
	], 
	[
		"X Component:="		, "Freq",
		"Y Component:="		, ["dB(St(P2,P1))"]
	])
oModule.CreateReport("S22", "Terminal Solution Data", "Rectangular Plot", "Setup1 : Sweep", 
	[
		"Domain:="		, "Sweep"
	], 
	[
		"Freq:="		, ["All"]
	], 
	[
		"X Component:="		, "Freq",
		"Y Component:="		, ["dB(St(P2,P2))"]
	])
